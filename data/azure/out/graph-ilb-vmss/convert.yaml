nodes:
  - key: frontend1
    routes: []
  - key: publicIp1/inbound
    routes:
      - destination: frontend1
  - key: publicIp2/inbound
    routes: []
  - key: frontend2
    routes:
      - destination: AzureBackbone/inbound
        constraints:
          destinationPort: '80'
          protocol: Tcp
        override:
          destinationIp: '192.168.202.20,192.168.200.4'
  - key: publicIp3/inbound
    routes:
      - destination: frontend2
  - key: Internet
    endpoint: true
    routes:
      - destination: publicIp1/inbound
        constraints:
          destinationIp: 20.47.120.40
      - destination: publicIp2/inbound
        constraints:
          destinationIp: 52.143.80.249
      - destination: publicIp3/inbound
        constraints:
          destinationIp: 52.143.80.173
  - key: AzureBackbone/outbound
    routes: []
  - key: frontend3
    routes:
      - destination: vnet1/inbound
        constraints:
          destinationPort: '3000'
          protocol: Tcp
        override:
          destinationIp: '192.168.202.2,192.168.202.4'
          destinationPort: '22'
  - key: loadBalancer1
    routes:
      - destination: frontend3
  - key: subnet1/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-test-vpn/providers/microsoft.network/virtualnetworks/x-test-vpn-vnet/subnets/gatewaysubnet/inbound
    routes: []
  - key: vm1
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.compute/virtualmachines/vnet-test-02
    endpoint: true
    routes:
      - destination: nic1/outbound
        constraints:
          sourceIp: 192.168.200.4
  - key: nic1/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.network/networkinterfaces/vnet-test-02598/inbound
    routes:
      - destination: vm1
    filters:
      - action: allow
        priority: 65000
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: vnet1
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 65001
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: AzureLoadBalancer
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
      - action: deny
        priority: 65500
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 100
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '22'
          protocol: TCP
  - key: nic1/outbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.network/networkinterfaces/vnet-test-02598/outbound
    routes:
      - destination: subnet2/outbound
    filters:
      - action: allow
        priority: 65000
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: vnet1
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 65001
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: Internet
          destinationPort: '*'
          protocol: '*'
      - action: deny
        priority: 65500
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 105
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '22'
          destinationIp: '*'
          destinationPort: '*'
          protocol: TCP
  - key: subnet2/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-test-vpn/providers/microsoft.network/virtualnetworks/x-test-vpn-vnet/subnets/openvpn-gateway/inbound
    routes:
      - destination: nic1/inbound
        constraints:
          destinationIp: 192.168.200.4
    filters:
      - action: allow
        priority: 65000
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: vnet1
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 65001
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: AzureLoadBalancer
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
      - action: deny
        priority: 65500
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 100
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '22'
          protocol: TCP
  - key: subnet2/outbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-test-vpn/providers/microsoft.network/virtualnetworks/x-test-vpn-vnet/subnets/openvpn-gateway/outbound
    routes:
      - destination: vnet1/router
    filters:
      - action: allow
        priority: 65000
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: vnet1
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 65001
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: Internet
          destinationPort: '*'
          protocol: '*'
      - action: deny
        priority: 65500
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
  - key: vm2
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.compute/virtualmachinescalesets/vmss/virtualmachines/0
    endpoint: true
    routes:
      - destination: nic2/outbound
        constraints:
          sourceIp: 192.168.202.1
  - key: nic2/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.compute/virtualmachinescalesets/vmss/virtualmachines/0/networkinterfaces/x-test-vpn-vnet-nic01/inbound
    routes:
      - destination: vm2
  - key: nic2/outbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.compute/virtualmachinescalesets/vmss/virtualmachines/0/networkinterfaces/x-test-vpn-vnet-nic01/outbound
    routes:
      - destination: subnet3/outbound
  - key: vm3
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.compute/virtualmachinescalesets/vmss/virtualmachines/4
    endpoint: true
    routes:
      - destination: nic3/outbound
        constraints:
          sourceIp: 192.168.202.3
  - key: nic3/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.compute/virtualmachinescalesets/vmss/virtualmachines/4/networkinterfaces/x-test-vpn-vnet-nic01/inbound
    routes:
      - destination: vm3
  - key: nic3/outbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.compute/virtualmachinescalesets/vmss/virtualmachines/4/networkinterfaces/x-test-vpn-vnet-nic01/outbound
    routes:
      - destination: subnet3/outbound
  - key: subnet3/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-test-vpn/providers/microsoft.network/virtualnetworks/x-test-vpn-vnet/subnets/vmss-subnet/inbound
    routes:
      - destination: nic2/inbound
        constraints:
          destinationIp: 192.168.202.1
      - destination: nic3/inbound
        constraints:
          destinationIp: 192.168.202.3
    filters:
      - action: allow
        priority: 65000
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: vnet1
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 65001
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: AzureLoadBalancer
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
      - action: deny
        priority: 65500
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 100
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '22'
          protocol: TCP
  - key: subnet3/outbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-test-vpn/providers/microsoft.network/virtualnetworks/x-test-vpn-vnet/subnets/vmss-subnet/outbound
    routes:
      - destination: vnet1/router
    filters:
      - action: allow
        priority: 65000
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: vnet1
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 65001
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: Internet
          destinationPort: '*'
          protocol: '*'
      - action: deny
        priority: 65500
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
  - key: vm4
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.compute/virtualmachines/vnet-test-01
    endpoint: true
    routes:
      - destination: nic4/outbound
        constraints:
          sourceIp: 192.168.202.20
  - key: nic4/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.network/networkinterfaces/vnet-test-01167/inbound
    routes:
      - destination: vm4
  - key: nic4/outbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/vnet-test-01/providers/microsoft.network/networkinterfaces/vnet-test-01167/outbound
    routes:
      - destination: vnet1/router
  - key: subnet4/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-test-vpn/providers/microsoft.network/virtualnetworks/x-test-vpn-vnet/subnets/no-nsg-subnet/inbound
    routes:
      - destination: nic4/inbound
        constraints:
          destinationIp: 192.168.202.20
  - key: subnet5/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-test-vpn/providers/microsoft.network/virtualnetworks/x-test-vpn-vnet/subnets/azurefirewallsubnet/inbound
    routes: []
  - key: vnet1/router
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-test-vpn/providers/microsoft.network/virtualnetworks/x-test-vpn-vnet
    range:
      sourceIp: '192.168.200.0-192.168.202.31, 192.168.202.64/26'
    routes:
      - destination: AzureBackbone/outbound
        constraints:
          destinationIp: 'except 192.168.200.0-192.168.202.31, 192.168.202.64/26'
      - destination: loadBalancer1
        constraints:
          destinationIp: 192.168.200.5
      - destination: vnet1/inbound
  - key: vnet1/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-test-vpn/providers/microsoft.network/virtualnetworks/x-test-vpn-vnet
    routes:
      - destination: subnet1/inbound
        constraints:
          destinationIp: 192.168.201.0/24
      - destination: subnet2/inbound
        constraints:
          destinationIp: 192.168.200.0/24
      - destination: subnet3/inbound
        constraints:
          destinationIp: 192.168.202.0/28
      - destination: subnet4/inbound
        constraints:
          destinationIp: 192.168.202.16/28
      - destination: subnet5/inbound
        constraints:
          destinationIp: 192.168.202.64/26
  - key: AzureBackbone/inbound
    routes:
      - destination: vnet1/router
        constraints:
          destinationIp: '192.168.200.0-192.168.202.31, 192.168.202.64/26'
symbols:
  - dimension: ip
    symbol: AzureLoadBalancer
    range: 168.63.129.16
  - dimension: protocol
    symbol: Tcp
    range: tcp
  - dimension: protocol
    symbol: TCP
    range: tcp
  - dimension: ip
    symbol: vnet1
    range: '192.168.200.0-192.168.202.31, 192.168.202.64/26'
  - dimension: ip
    symbol: Internet
    range: 'except 192.168.200.0-192.168.202.31, 192.168.202.64/26'
