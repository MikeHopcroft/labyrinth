nodes:
  - key: frontend1
    routes:
      - destination: AzureBackbone/inbound
        constraints:
          destinationPort: '80'
          protocol: Tcp
        override:
          destinationIp: 192.168.10.4
  - key: publicIp1/inbound
    routes:
      - destination: frontend1
  - key: Internet
    endpoint: true
    routes:
      - destination: publicIp1/inbound
        constraints:
          destinationIp: 52.151.49.75
  - key: AzureBackbone/outbound
    routes: []
  - key: vm1
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.compute/virtualmachines/vm-a-01
    endpoint: true
    routes:
      - destination: nic1/outbound
        constraints:
          sourceIp: 192.168.10.4
  - key: nic1/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.network/networkinterfaces/vm-a-01125/inbound
    routes:
      - destination: vm1
  - key: nic1/outbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.network/networkinterfaces/vm-a-01125/outbound
    routes:
      - destination: vnet1/router
  - key: subnet1/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.network/virtualnetworks/x-bad-vnet-a/subnets/subnet-a/inbound
    routes:
      - destination: nic1/inbound
        constraints:
          destinationIp: 192.168.10.4
  - key: vnet1/router
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.network/virtualnetworks/x-bad-vnet-a
    range:
      sourceIp: 192.168.10.0/24
    routes:
      - destination: AzureBackbone/outbound
        constraints:
          destinationIp: except 192.168.10.0/24
      - destination: vnet1/inbound
  - key: vnet1/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.network/virtualnetworks/x-bad-vnet-a
    routes:
      - destination: subnet1/inbound
        constraints:
          destinationIp: 192.168.10.0/28
  - key: frontend2
    routes:
      - destination: vnet2/inbound
        constraints:
          destinationPort: '80'
          protocol: Tcp
        override:
          destinationIp: 192.168.10.4
  - key: frontend3
    routes:
      - destination: vnet2/inbound
        constraints:
          destinationPort: '8080'
          protocol: Tcp
        override:
          destinationIp: 192.168.10.4
          destinationPort: '81'
  - key: loadBalancer1
    routes:
      - destination: frontend2
      - destination: frontend3
  - key: vm2
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.compute/virtualmachines/vm-b-01
    endpoint: true
    routes:
      - destination: nic2/outbound
        constraints:
          sourceIp: 192.168.10.4
  - key: nic2/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.network/networkinterfaces/vm-b-01466/inbound
    routes:
      - destination: vm2
  - key: nic2/outbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.network/networkinterfaces/vm-b-01466/outbound
    routes:
      - destination: vnet2/router
  - key: subnet2/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.network/virtualnetworks/x-bad-vnet-b/subnets/subnet-b/inbound
    routes:
      - destination: nic2/inbound
        constraints:
          destinationIp: 192.168.10.4
  - key: vnet2/router
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.network/virtualnetworks/x-bad-vnet-b
    range:
      sourceIp: 192.168.10.0/24
    routes:
      - destination: AzureBackbone/outbound
        constraints:
          destinationIp: except 192.168.10.0/24
      - destination: loadBalancer1
        constraints:
          destinationIp: '192.168.10.5,192.168.10.6'
      - destination: vnet2/inbound
  - key: vnet2/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-bad-vnet/providers/microsoft.network/virtualnetworks/x-bad-vnet-b
    routes:
      - destination: subnet2/inbound
        constraints:
          destinationIp: 192.168.10.0/28
  - key: AzureBackbone/inbound
    routes:
      - destination: vnet1/router
        constraints:
          destinationIp: 192.168.10.0/24
      - destination: vnet2/router
        constraints:
          destinationIp: 192.168.10.0/24
symbols:
  - dimension: ip
    symbol: AzureLoadBalancer
    range: 168.63.129.16
  - dimension: protocol
    symbol: Tcp
    range: tcp
  - dimension: protocol
    symbol: TCP
    range: tcp
  - dimension: ip
    symbol: vnet1
    range: 192.168.10.0/24
  - dimension: ip
    symbol: vnet2
    range: 192.168.10.0/24
  - dimension: ip
    symbol: Internet
    range: 'except 192.168.10.0/24,192.168.10.0/24'
